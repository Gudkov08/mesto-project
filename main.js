(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{Cy:()=>j,Lu:()=>U,Ht:()=>D});var t=["inputSelector","submitButtonSelector","inactiveButtonClass"];function n(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},c=Object.keys(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit",inactiveButtonClass:"form__submit_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},r=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n),t.disabled=!1):(t.classList.add(n),t.disabled=!0)};function c(e){"Escape"===e.key&&u(document.querySelector(".popup_opened"))}function a(e){e.target.classList.contains("popup")&&u(document.querySelector(".popup_opened"))}function i(e){e.classList.add("popup_opened"),document.addEventListener("keydown",c),e.addEventListener("click",a)}function u(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",c),e.removeEventListener("click",a)}function l(e){e.querySelector(o.formSelector).reset(),e.querySelector(o.submitButtonSelector).disabled=!0,e.querySelector(o.submitButtonSelector).classList.add(o.inactiveButtonClass)}var s=document.querySelector("input[name=profile-name]"),d=document.querySelector("input[name=profile-description]"),f=document.querySelector(".profile__name"),m=document.querySelector(".profile__description"),v=document.querySelector(".profile__img"),_=document.querySelector("#POPUP-EDIT-PROFILE"),y=_.querySelector(".form__submit"),p={};var h={baseUrl:"https://nomoreparties.co/v1/plus-cohort-1",headers:{Authorization:"4ac8521d-70a9-440e-8460-55ec053aa485","Content-Type":"application/json"}},S=function(e){return e.ok?e.json():Promise.reject("ошибка ".concat(e.status))};function b(e,t){var n=document.querySelector("#AddNewCard").content.querySelector(".elements__card").cloneNode(!0),o=n.querySelector(".elements__card-image"),r=n.querySelector(".elements__card-title"),c=n.querySelector(".elements__likes-number");r.textContent=e.name,o.alt=e.name,o.src=e.link,c.textContent=e.likes.length;for(var a=n.querySelector(".elements__card-button"),l=0;l<e.likes.length;l++)if(e.likes[l]._id===t._id){a.classList.add("elements__card-button_active");break}a.addEventListener("click",(function(t){var n=t.target;a.classList.contains("elements__card-button_active")?(function(e){return fetch("".concat(h.baseUrl,"/cards/likes/")+e._id,{method:"DELETE",headers:h.headers}).then(S).catch((function(e){console.log(e)}))}(e).then((function(e){c.textContent=e.likes.length})),n.classList.remove("elements__card-button_active")):(function(e){return fetch("".concat(h.baseUrl,"/cards/likes/")+e._id,{method:"PUT",headers:h.headers}).then(S).catch((function(e){console.log(e)}))}(e).then((function(e){c.textContent=e.likes.length})),n.classList.add("elements__card-button_active"))}));var s=n.querySelector(".button_type_trash");e.owner._id!=t._id&&s.remove(),s.addEventListener("click",(function(){!function(e,t,n){i(e),j.addEventListener("submit",(function(){!function(e,t){(function(e){return fetch("".concat(h.baseUrl,"/cards/")+e._id,{method:"DELETE",headers:h.headers}).then(S).catch((function(e){console.log(e)}))})(e).then((function(){t.closest(".elements__card").remove(),u(D)})).catch((function(e){console.log(e)}))}(t,n),console.log("123")}))}(D,e,s)}));var d=n.querySelector(".elements__card-image"),f=document.querySelector("#POPUP-IMAGE-LARGE");return d.addEventListener("click",(function(e){i(f);var t=f.querySelector(".imgPopup__image"),n=f.querySelector(".imgPopup__caption");t.src=o.src,n.textContent=r.textContent})),n}var q,E,L,C=document.querySelector(".elements__list");Promise.all([fetch("".concat(h.baseUrl,"/cards"),{headers:h.headers}).then(S),fetch("".concat(h.baseUrl,"/users/me"),{headers:h.headers}).then(S)]).then((function(e){var t;!function(e,t){e.forEach((function(e){var n=b(e,t);C.prepend(n)}))}(e[0],e[1]),t=e[1],f.textContent=t.name,m.textContent=t.about,v.src=t.avatar,function(e){Object.assign(p,e)}(t)})).catch((function(e){console.log(e)})),E=(q=o).formSelector,L=n(q,["formSelector"]),Array.from(document.querySelectorAll(E)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),Array.from(e.querySelectorAll(".form__set")).forEach((function(e){!function(e,o){var c=o.inputSelector,a=o.submitButtonSelector,i=o.inactiveButtonClass,u=n(o,t),l=Array.from(e.querySelectorAll(c)),s=e.querySelector(a);r(l,s,i),l.forEach((function(t){t.addEventListener("input",(function(){!function(e,t,n){var o=n.inputErrorClass,r=n.errorClass;t.validity.valid?function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n),r.classList.remove(o),r.textContent=""}(e,t,o,r):function(e,t,n,o,r){var c=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o),c.textContent=n,c.classList.add(r)}(e,t,t.validationMessage,o,r)}(e,t,u),r(l,s,i)}))}))}(e,L)}))}));var g=document.querySelector(".button_type_edit"),P=document.forms.editProfile,k=document.querySelector(".profile__add-btn"),O=document.forms.newCard,A=document.querySelector("#POPUP-IMAGE-LARGE"),x=document.querySelector("#POPUP-NEW-CARD"),U=document.querySelector("#POPUP-CHANGE-AVATAR"),w=document.forms.changeAvatar,D=document.querySelector("#POPUP-DELETE-CARD"),j=document.forms.deleteCard;g.addEventListener("click",(function(){i(_),s.value=f.textContent,d.value=m.textContent})),_.querySelector(".button_type_close").addEventListener("click",(function(){u(_)})),P.addEventListener("submit",(function(e){var t,n;e.preventDefault(),y.textContent="Сохранение...",(t=s.value,n=d.value,fetch("".concat(h.baseUrl,"/users/me"),{method:"PATCH",headers:h.headers,body:JSON.stringify({name:t,about:n})}).then(S).catch((function(e){console.log(e)}))).then((function(){f.textContent=s.value,m.textContent=d.value,u(_),l(_)})).catch((function(e){console.log(e)})).finally((function(){y.textContent="Сохранить"}))})),k.addEventListener("click",(function(){i(x)})),x.querySelector(".button_type_close").addEventListener("click",(function(){u(x)})),O.addEventListener("submit",(function(e){var t=document.querySelector("#POPUP-NEW-CARD"),n=t.querySelector(".form__submit"),o={};o.name=t.querySelector("input[name=newCardName]").value,o.link=t.querySelector("input[name=newCardLink]").value,o.likes=[],o.owner={},o.owner._id=p._id;var r=b(o,p);e.preventDefault(),n.textContent="Сохранение...",function(e){return fetch("".concat(h.baseUrl,"/cards"),{method:"POST",headers:h.headers,body:JSON.stringify({name:e.name,link:e.link})}).then(S).catch((function(e){console.log(e)}))}(o).then((function(){C.prepend(r),u(t),l(t)})).catch((function(e){console.log(e)})).finally((function(){n.textContent="Создать"}))})),A.querySelector(".button_type_close").addEventListener("click",(function(){u(A)})),v.addEventListener("click",(function(){i(U)})),U.querySelector(".button_type_close").addEventListener("click",(function(){u(U)})),w.addEventListener("submit",(function(e){var t,n=U.querySelector("input[name=newAvatarLink]").value,o=U.querySelector(".form__submit");e.preventDefault(),o.textContent="Загрузка...",(t=n,fetch("".concat(h.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:h.headers,body:JSON.stringify({avatar:t})}).then(S).catch((function(e){console.log(e)}))).then((function(){v.src=n,u(U),l(U)})).catch((function(e){console.log(e)})).finally((function(){o.textContent="Сохранить"}))})),D.querySelector(".button_type_close").addEventListener("click",(function(){u(D)}))})();